<script setup>
import { ref, onMounted, watch } from 'vue';
import axios from 'axios';

const open = ref(false);
const selectedInstance = ref(null);
const getLoading = ref(true)
const props = defineProps({
    modelValue: {
        type: Object,
        default: null,
    },
    token: {
        type: String,
        default: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzIxODIwNTYyLCJpYXQiOjE3MjE3MzQxNjIsImp0aSI6IjA1YjgyYmZlNjczOTQxMWJiZGEwMGFhZmFmM2QzY2MyIiwidXNlcl9pZCI6IjYyNGRmZTIzLTkyZDAtNDNmMS04MDYxLWEyMzIxZjJiNWViYiJ9.RJqgwYS5q16Gqj_Tm0-DjUqeMIAYxcMGOyqrTJOPJ5Y',
    },
    type: String,
    webhooks: Boolean,
    client: {
        type: String,
        default: '624dfe23-92d0-43f1-8061-a2321f2b5ebb',
    },
    url: {
        type: String,
        default: 'http://localhost:8000/v1/api/instances/instance/',
    },
    status_url: {
        type: String,
        default: 'http://localhost:8000/v1/api/instances/status_instance/',
    },
});

const emit = defineEmits(['update:modelValue']);

const instances = ref(null);

async function getInstances() {
    try {
        let url = props.url;
        let status_url = props.status_url;
        let params = `?client=${props.client}`;
        if (props.type) params += `&type=${props.type}`;
        if (props.webhooks) params += `&webhooks=${props.webhooks}`;

        const response = await axios.get(`${url}`, {
            headers: {
                Authorization: `Bearer ${props.token}`,
            },
        });
        instances.value = response.data.results;
        instances.value.forEach(async (key) => {
            key.isLoading = true;
            try {
                const statusResponse = await axios.get(
                    `${status_url}?instance=${key.id}`,
                    { headers: { Authorization: `Bearer ${props.token}` } }
                );
                if (statusResponse.data.instance_status !== 'Disconnected') {
                    key.status = true;
                } else {
                    key.status = false;
                }
            } catch (err) {
                key.status = 'Offline';
            }
            key.isLoading = false;
        });
    } catch (err) {
        console.log(err);
    }
    getLoading.value = false
}

watch(
    () => props.modelValue,
    (newValue) => {
        selectedInstance.value = newValue;
    },
    { immediate: true }
);

watch(selectedInstance, (newValue) => {
    emit('update:modelValue', newValue);
});

onMounted(async () => {
    await getInstances();
});
</script>
<template>
    <main class="w-full relative text-white">
        <div @click="open = !open" :class="{ 'rounded-b-none': open }"
            class="rounded-lg shadow shadow-gray-900 bg-base-100 p-2 px-4 text-center">
            <div class="flex cursor-pointer justify-between items-center">
                <p class="w-full select-none">
                <div v-if="!getLoading">
                    <span v-if="!selectedInstance">{{ instances ? instances.length : 'Sem' }} Instâncias
                        disponíveis</span>
                    <span class="flex items-center  gap-2" v-else>
                        <header class="flex gap-3 items-center flex-shrink-0">
                            <svg v-if="selectedInstance.type === 'whatsapp-qrcode'" xmlns="http://www.w3.org/2000/svg"
                                fill="currentColor" class="w-5 h-5 text-green-400" viewBox="0 0 16 16">
                                <path
                                    d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z" />
                            </svg>
                            <svg v-if="selectedInstance.type === 'whatsapp-api-official'"
                                class="h-5 w-5 mt-1 text-green-400" xmlns="http://www.w3.org/2000/svg" width="26"
                                height="24" viewBox="0 0 26 24" fill="none">
                                <g filter="url(#filter0_d_1393_492)">
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M15.0313 0.599454C15.9939 0.998793 16.8675 1.58573 17.601 2.32605C18.3397 3.06088 18.9247 3.93462 19.3243 4.89693C19.7238 5.85924 19.929 6.89109 19.928 7.93305C19.9279 8.07377 19.9241 8.21365 19.9167 8.35259C19.8319 8.31268 19.7413 8.27036 19.6446 8.22551C19.232 8.03432 18.882 7.8685 18.5833 7.72357C18.5603 6.92804 18.3926 6.14274 18.0879 5.40628C17.757 4.60647 17.271 3.8801 16.658 3.26905C16.0471 2.65561 15.3208 2.16916 14.521 1.83774C13.7212 1.50632 12.8637 1.3365 11.998 1.33805C8.364 1.33805 5.407 4.29605 5.407 7.92205C5.40465 9.16208 5.75381 10.3774 6.414 11.427L6.57 11.678L5.904 14.111L8.398 13.457L8.638 13.601C9.08609 13.8669 9.56213 14.0773 10.0556 14.2294C10.0188 14.6669 10 15.0932 10 15.5C10 15.536 10.0002 15.5721 10.0007 15.608C9.37752 15.4461 8.77396 15.2082 8.204 14.898L4 16L5.121 11.891C4.43 10.686 4.064 9.32505 4.064 7.92605C4.068 3.55805 7.627 4.93305e-05 11.994 4.93305e-05C13.0362 -0.00364427 14.0687 0.200115 15.0313 0.599454ZM11.3127 9.01024C11.1234 9.44723 10.9533 9.91151 10.8031 10.3916C9.69535 9.53633 8.97603 8.49875 8.8099 8.25911C8.79528 8.23802 8.78494 8.22311 8.779 8.21505L8.77739 8.21291C8.67164 8.07229 7.969 7.13797 7.969 6.16605C7.969 5.24848 8.41796 4.77017 8.62334 4.55135C8.63665 4.53718 8.64893 4.52409 8.66 4.51205C8.7264 4.43665 8.80766 4.37579 8.89869 4.33328C8.98973 4.29078 9.08856 4.26755 9.189 4.26505C9.322 4.26505 9.455 4.26505 9.569 4.27205C9.58321 4.27263 9.59798 4.27241 9.61323 4.27219C9.72893 4.27048 9.87264 4.26836 10.014 4.61205C10.0845 4.77848 10.1958 5.04894 10.3045 5.31331C10.4531 5.67479 10.5971 6.02487 10.626 6.08205C10.675 6.18105 10.706 6.29505 10.641 6.42905C10.6316 6.44804 10.623 6.46604 10.6146 6.48327C10.5651 6.58584 10.5286 6.66145 10.443 6.75905C10.4062 6.80148 10.3678 6.84807 10.3296 6.89438C10.2653 6.97249 10.2016 7.0498 10.147 7.10505C10.048 7.20405 9.945 7.31005 10.059 7.50805C10.177 7.70505 10.572 8.35505 11.162 8.88005C11.2128 8.92552 11.263 8.96888 11.3127 9.01024Z"
                                        fill="currentColor" />
                                </g>
                                <path
                                    d="M25.4179 10.1494C25.2249 9.55078 24.9854 8.96709 24.6728 8.40585C24.3634 7.84835 23.9709 7.30956 23.4653 6.86057C22.963 6.41532 22.3044 6.07857 21.6058 6.01497L21.3464 6C21.2565 6.00374 21.1568 6.00374 21.0636 6.01497C20.874 6.03742 20.6944 6.08606 20.5247 6.14218C20.1821 6.26191 19.8827 6.44151 19.62 6.63607C19.1476 6.98778 18.7717 7.39562 18.4324 7.81468C18.4358 7.82216 18.4424 7.8259 18.4457 7.83339L18.5189 7.93815C18.6886 8.18884 19.0578 8.76505 19.3871 9.38615C19.7963 8.93716 20.3285 8.39463 20.548 8.23748C20.7143 8.12149 20.8773 8.03169 21.0237 7.98305C21.1002 7.9606 21.1701 7.94189 21.2366 7.93815C21.2699 7.93067 21.2998 7.93441 21.3364 7.93067L21.4628 7.93815C21.7888 7.97183 22.1081 8.12149 22.4108 8.3834C23.0129 8.92219 23.4886 9.83889 23.7979 10.808C24.1139 11.7808 24.2936 12.8434 24.3035 13.8686C24.3035 14.3587 24.247 14.8302 24.1139 15.2193C23.9842 15.6122 23.6549 15.7618 23.2823 15.7618C22.7401 15.7618 22.3476 15.4999 22.0316 15.1333C21.6857 14.7254 21.3597 14.2689 21.047 13.7825C20.7875 13.3747 20.5347 12.9519 20.2952 12.5216C19.8728 11.7508 19.3073 10.7743 18.9148 9.95862L18 8.40585C17.8969 8.25993 17.7971 8.11401 17.6873 7.96808C17.3181 7.49664 16.9089 7.03268 16.38 6.63607C16.1173 6.44151 15.8179 6.26191 15.4753 6.14218C15.3056 6.08606 15.126 6.03742 14.9364 6.01497C14.8765 6.00748 14.8166 6.00374 14.7568 6.00374C14.7202 6.00374 14.6869 6 14.6536 6L14.3942 6.01497C13.6956 6.07857 13.037 6.41532 12.5347 6.86057C12.0291 7.30956 11.6366 7.84835 11.3272 8.40585C11.0146 8.96709 10.7751 9.55078 10.5821 10.1494C10.2062 11.3468 10.0033 12.5852 10 13.8649C10.0033 14.5309 10.0798 15.2231 10.3193 15.9115C10.5522 16.585 10.9913 17.2996 11.6898 17.6963C12.0324 17.8946 12.4216 17.9993 12.7942 17.9993C13.2033 18.0106 13.5925 17.8796 13.9019 17.7112C14.5239 17.3633 14.953 16.903 15.3422 16.4391C16.1106 15.4999 16.6794 14.4822 17.205 13.4458C17.3514 13.1614 17.4911 12.8696 17.6274 12.574C17.5576 12.4206 17.4877 12.2597 17.4146 12.0913C17.2083 11.7059 16.9522 11.2495 16.7659 10.9314C16.4898 11.4927 16.2037 12.039 15.9077 12.5815C15.3788 13.5244 14.81 14.4411 14.1746 15.1931C13.8586 15.5598 13.5094 15.8816 13.2033 16.035C13.047 16.1098 12.9272 16.136 12.8241 16.1285C12.6811 16.1285 12.5613 16.0911 12.4482 16.0238C12.2254 15.8928 12.0158 15.6122 11.8861 15.2193C11.753 14.8302 11.6965 14.3587 11.6965 13.8686C11.7064 12.8434 11.8861 11.7808 12.2021 10.808C12.5114 9.83889 12.9871 8.92219 13.5892 8.3834C13.8919 8.12149 14.2112 7.97183 14.5372 7.93815L14.6636 7.93067C14.7002 7.93441 14.7301 7.93067 14.7634 7.93815C14.8299 7.94189 14.8998 7.9606 14.9763 7.98305C15.0628 8.01298 15.1559 8.05414 15.2524 8.11027C15.3189 8.14768 15.3854 8.18884 15.452 8.23748C15.7846 8.47694 16.1139 8.82865 16.4233 9.21778C16.6628 9.52085 16.8923 9.85759 17.1218 10.2018L18 11.7321C18.2495 12.3121 18.5089 12.8883 18.795 13.4458C19.3206 14.4822 19.8894 15.4999 20.6578 16.4391C20.884 16.7122 21.1268 16.9816 21.4129 17.2248C21.6158 17.4044 21.8387 17.5653 22.0981 17.7112C22.4075 17.8796 22.7967 18.0106 23.2058 17.9993C23.5784 17.9993 23.9676 17.8946 24.3102 17.6963C25.0087 17.2996 25.4478 16.585 25.6807 15.9115C25.9202 15.2231 25.9967 14.5309 26 13.8649C25.9967 12.5852 25.7938 11.3468 25.4179 10.1494Z"
                                    fill="#0081FB" />
                                <defs>
                                    <filter id="filter0_d_1393_492" x="0" y="0" width="23.9277" height="24"
                                        filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                        <feFlood flood-opacity="0" result="BackgroundImageFix" />
                                        <feColorMatrix in="SourceAlpha" type="matrix"
                                            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                                        <feOffset dy="4" />
                                        <feGaussianBlur stdDeviation="2" />
                                        <feComposite in2="hardAlpha" operator="out" />
                                        <feColorMatrix type="matrix"
                                            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" />
                                        <feBlend mode="normal" in2="BackgroundImageFix"
                                            result="effect1_dropShadow_1393_492" />
                                        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1393_492"
                                            result="shape" />
                                    </filter>
                                </defs>
                            </svg>
                            <div v-if="selectedInstance" class="relative group">
                                <div :class="{ 'bg-red-500/80': selectedInstance.status === false, 'bg-green-500': selectedInstance.status === true, 'bg-purple-500': selectedInstance.status === 'Offline' }"
                                    class="w-5 h-5 text-xs shadow flex justify-start shadow-gray-900 rounded-full cursor-pointer group-hover:w-auto group-hover:px-2 transition-all duration-200 ease-in-out">
                                    <span class="hidden mt-[1px] text-center font-semibold group-hover:inline-block">
                                        {{ selectedInstance.status === true ? 'Conectado' : selectedInstance.status ===
            false ? 'Desconectado' :
            'Indefinido' }}
                                    </span>
                                </div>
                            </div>
                        </header>
                        <div class="w-full">{{
            selectedInstance.name }}</div>
                    </span>
                </div>
                <div v-else class="flex items-center gap-2 justify-center"><svg aria-hidden="true"
                        class="inline w-5 h-5 text-blue-300 animate-spin  fill-gray-600" viewBox="0 0 100 101"
                        fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
                            fill="currentColor" />
                        <path
                            d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
                            fill="currentFill" />
                    </svg>Carregando instâncias...</div>
                </p>
                <footer class="flex items-center gap-2"><button @click="selectedInstance = null"><svg class="w-4 h-4"
                            aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                            viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18 17.94 6M18 18 6.06 6" />
                        </svg></button>
                    <button>
                        <svg :class="{ 'rotate-180': open }" class="w-4 h-4 ease-out transition" aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m19 9-7 7-7-7" />
                        </svg>
                    </button>
                </footer>
            </div>
        </div>

        <nav v-if="open"
            class="rounded-b-lg absolute top-[40px] w-full z-20 text-sm  shadow shadow-gray-900 bg-base-300 p-2">
            <ul class="gap-2 flex flex-col">
                <li v-if="instances.length > 0" v-for="inst, index in instances"
                    :class="selectedInstance && selectedInstance.id === inst.id ? 'bg-sky-400/50' : 'bg-base-100/50 hover:bg-base-200/90'"
                    class=" select-none cursor-pointer w-full rounded-lg">
                    <button @click="selectedInstance = inst, open = false"
                        :disabled="selectedInstance && selectedInstance.id === inst.id"
                        class="flex p-2 justify-between gap-2 divide-x-2 divide-gray-900 w-full">
                        <div class="flex w-full items-center px-2 gap-2 justify-between">
                            <svg v-if="inst.type === 'whatsapp-qrcode'" xmlns="http://www.w3.org/2000/svg"
                                fill="currentColor" class="w-5 h-5 flex-shrink-0 text-green-400" viewBox="0 0 16 16">
                                <path
                                    d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z" />
                            </svg>
                            <svg v-if="inst.type === 'whatsapp-api-official'"
                                class="w-5 h-5 flex-shrink-0 text-green-400" xmlns="http://www.w3.org/2000/svg"
                                width="26" height="24" viewBox="0 0 26 24" fill="none">
                                <g filter="url(#filter0_d_1393_492)">
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M15.0313 0.599454C15.9939 0.998793 16.8675 1.58573 17.601 2.32605C18.3397 3.06088 18.9247 3.93462 19.3243 4.89693C19.7238 5.85924 19.929 6.89109 19.928 7.93305C19.9279 8.07377 19.9241 8.21365 19.9167 8.35259C19.8319 8.31268 19.7413 8.27036 19.6446 8.22551C19.232 8.03432 18.882 7.8685 18.5833 7.72357C18.5603 6.92804 18.3926 6.14274 18.0879 5.40628C17.757 4.60647 17.271 3.8801 16.658 3.26905C16.0471 2.65561 15.3208 2.16916 14.521 1.83774C13.7212 1.50632 12.8637 1.3365 11.998 1.33805C8.364 1.33805 5.407 4.29605 5.407 7.92205C5.40465 9.16208 5.75381 10.3774 6.414 11.427L6.57 11.678L5.904 14.111L8.398 13.457L8.638 13.601C9.08609 13.8669 9.56213 14.0773 10.0556 14.2294C10.0188 14.6669 10 15.0932 10 15.5C10 15.536 10.0002 15.5721 10.0007 15.608C9.37752 15.4461 8.77396 15.2082 8.204 14.898L4 16L5.121 11.891C4.43 10.686 4.064 9.32505 4.064 7.92605C4.068 3.55805 7.627 4.93305e-05 11.994 4.93305e-05C13.0362 -0.00364427 14.0687 0.200115 15.0313 0.599454ZM11.3127 9.01024C11.1234 9.44723 10.9533 9.91151 10.8031 10.3916C9.69535 9.53633 8.97603 8.49875 8.8099 8.25911C8.79528 8.23802 8.78494 8.22311 8.779 8.21505L8.77739 8.21291C8.67164 8.07229 7.969 7.13797 7.969 6.16605C7.969 5.24848 8.41796 4.77017 8.62334 4.55135C8.63665 4.53718 8.64893 4.52409 8.66 4.51205C8.7264 4.43665 8.80766 4.37579 8.89869 4.33328C8.98973 4.29078 9.08856 4.26755 9.189 4.26505C9.322 4.26505 9.455 4.26505 9.569 4.27205C9.58321 4.27263 9.59798 4.27241 9.61323 4.27219C9.72893 4.27048 9.87264 4.26836 10.014 4.61205C10.0845 4.77848 10.1958 5.04894 10.3045 5.31331C10.4531 5.67479 10.5971 6.02487 10.626 6.08205C10.675 6.18105 10.706 6.29505 10.641 6.42905C10.6316 6.44804 10.623 6.46604 10.6146 6.48327C10.5651 6.58584 10.5286 6.66145 10.443 6.75905C10.4062 6.80148 10.3678 6.84807 10.3296 6.89438C10.2653 6.97249 10.2016 7.0498 10.147 7.10505C10.048 7.20405 9.945 7.31005 10.059 7.50805C10.177 7.70505 10.572 8.35505 11.162 8.88005C11.2128 8.92552 11.263 8.96888 11.3127 9.01024Z"
                                        fill="currentColor" />
                                </g>
                                <path
                                    d="M25.4179 10.1494C25.2249 9.55078 24.9854 8.96709 24.6728 8.40585C24.3634 7.84835 23.9709 7.30956 23.4653 6.86057C22.963 6.41532 22.3044 6.07857 21.6058 6.01497L21.3464 6C21.2565 6.00374 21.1568 6.00374 21.0636 6.01497C20.874 6.03742 20.6944 6.08606 20.5247 6.14218C20.1821 6.26191 19.8827 6.44151 19.62 6.63607C19.1476 6.98778 18.7717 7.39562 18.4324 7.81468C18.4358 7.82216 18.4424 7.8259 18.4457 7.83339L18.5189 7.93815C18.6886 8.18884 19.0578 8.76505 19.3871 9.38615C19.7963 8.93716 20.3285 8.39463 20.548 8.23748C20.7143 8.12149 20.8773 8.03169 21.0237 7.98305C21.1002 7.9606 21.1701 7.94189 21.2366 7.93815C21.2699 7.93067 21.2998 7.93441 21.3364 7.93067L21.4628 7.93815C21.7888 7.97183 22.1081 8.12149 22.4108 8.3834C23.0129 8.92219 23.4886 9.83889 23.7979 10.808C24.1139 11.7808 24.2936 12.8434 24.3035 13.8686C24.3035 14.3587 24.247 14.8302 24.1139 15.2193C23.9842 15.6122 23.6549 15.7618 23.2823 15.7618C22.7401 15.7618 22.3476 15.4999 22.0316 15.1333C21.6857 14.7254 21.3597 14.2689 21.047 13.7825C20.7875 13.3747 20.5347 12.9519 20.2952 12.5216C19.8728 11.7508 19.3073 10.7743 18.9148 9.95862L18 8.40585C17.8969 8.25993 17.7971 8.11401 17.6873 7.96808C17.3181 7.49664 16.9089 7.03268 16.38 6.63607C16.1173 6.44151 15.8179 6.26191 15.4753 6.14218C15.3056 6.08606 15.126 6.03742 14.9364 6.01497C14.8765 6.00748 14.8166 6.00374 14.7568 6.00374C14.7202 6.00374 14.6869 6 14.6536 6L14.3942 6.01497C13.6956 6.07857 13.037 6.41532 12.5347 6.86057C12.0291 7.30956 11.6366 7.84835 11.3272 8.40585C11.0146 8.96709 10.7751 9.55078 10.5821 10.1494C10.2062 11.3468 10.0033 12.5852 10 13.8649C10.0033 14.5309 10.0798 15.2231 10.3193 15.9115C10.5522 16.585 10.9913 17.2996 11.6898 17.6963C12.0324 17.8946 12.4216 17.9993 12.7942 17.9993C13.2033 18.0106 13.5925 17.8796 13.9019 17.7112C14.5239 17.3633 14.953 16.903 15.3422 16.4391C16.1106 15.4999 16.6794 14.4822 17.205 13.4458C17.3514 13.1614 17.4911 12.8696 17.6274 12.574C17.5576 12.4206 17.4877 12.2597 17.4146 12.0913C17.2083 11.7059 16.9522 11.2495 16.7659 10.9314C16.4898 11.4927 16.2037 12.039 15.9077 12.5815C15.3788 13.5244 14.81 14.4411 14.1746 15.1931C13.8586 15.5598 13.5094 15.8816 13.2033 16.035C13.047 16.1098 12.9272 16.136 12.8241 16.1285C12.6811 16.1285 12.5613 16.0911 12.4482 16.0238C12.2254 15.8928 12.0158 15.6122 11.8861 15.2193C11.753 14.8302 11.6965 14.3587 11.6965 13.8686C11.7064 12.8434 11.8861 11.7808 12.2021 10.808C12.5114 9.83889 12.9871 8.92219 13.5892 8.3834C13.8919 8.12149 14.2112 7.97183 14.5372 7.93815L14.6636 7.93067C14.7002 7.93441 14.7301 7.93067 14.7634 7.93815C14.8299 7.94189 14.8998 7.9606 14.9763 7.98305C15.0628 8.01298 15.1559 8.05414 15.2524 8.11027C15.3189 8.14768 15.3854 8.18884 15.452 8.23748C15.7846 8.47694 16.1139 8.82865 16.4233 9.21778C16.6628 9.52085 16.8923 9.85759 17.1218 10.2018L18 11.7321C18.2495 12.3121 18.5089 12.8883 18.795 13.4458C19.3206 14.4822 19.8894 15.4999 20.6578 16.4391C20.884 16.7122 21.1268 16.9816 21.4129 17.2248C21.6158 17.4044 21.8387 17.5653 22.0981 17.7112C22.4075 17.8796 22.7967 18.0106 23.2058 17.9993C23.5784 17.9993 23.9676 17.8946 24.3102 17.6963C25.0087 17.2996 25.4478 16.585 25.6807 15.9115C25.9202 15.2231 25.9967 14.5309 26 13.8649C25.9967 12.5852 25.7938 11.3468 25.4179 10.1494Z"
                                    fill="#0081FB" />
                                <defs>
                                    <filter id="filter0_d_1393_492" x="0" y="0" width="23.9277" height="24"
                                        filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                        <feFlood flood-opacity="0" result="BackgroundImageFix" />
                                        <feColorMatrix in="SourceAlpha" type="matrix"
                                            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                                        <feOffset dy="4" />
                                        <feGaussianBlur stdDeviation="2" />
                                        <feComposite in2="hardAlpha" operator="out" />
                                        <feColorMatrix type="matrix"
                                            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" />
                                        <feBlend mode="normal" in2="BackgroundImageFix"
                                            result="effect1_dropShadow_1393_492" />
                                        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1393_492"
                                            result="shape" />
                                    </filter>
                                </defs>
                            </svg>
                            <p class="w-full text-center">{{ inst.name }} </p>
                            <div v-if="!inst.isLoading" class="relative group">
                                <div :class="{ 'bg-red-500/80': inst.status === false, 'bg-green-500': inst.status === true, 'bg-purple-500': inst.status === 'Offline' }"
                                    class="w-5 h-5 text-xs shadow flex justify-start shadow-gray-900 rounded-full cursor-pointer group-hover:w-auto group-hover:px-2 transition-all duration-200 ease-in-out">
                                    <span class="hidden mt-[1px] text-center font-semibold group-hover:inline-block">
                                        {{ inst.status === true ? 'Conectado' : inst.status === false ? 'Desconectado' :
            'Indefinido' }}
                                    </span>
                                </div>
                            </div>
                            <div v-else> <svg aria-hidden="true"
                                    class="inline w-4 h-4 text-blue-300 flex-shrink-0 animate-spin fill-gray-700"
                                    viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
                                        fill="currentColor" />
                                    <path
                                        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
                                        fill="currentFill" />
                                </svg></div>

                            <svg :class="inst.webhooks ? 'text-green-500' : 'text-red-600'"
                                class="w-5 h-5 shadow shadow-gray-900 p-[3px] rounded-full bg-base-300 flex-shrink-0"
                                aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                fill="currentColor" viewBox="0 0 24 24">
                                <path fill-rule="evenodd"
                                    d="M18.458 3.11A1 1 0 0 1 19 4v16a1 1 0 0 1-1.581.814L12 16.944V7.056l5.419-3.87a1 1 0 0 1 1.039-.076ZM22 12c0 1.48-.804 2.773-2 3.465v-6.93c1.196.692 2 1.984 2 3.465ZM10 8H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6V8Zm0 9H5v3a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-3Z"
                                    clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="flex w-full px-2 justify-center">
                            {{ inst.telephone }}
                        </div>
                    </button>
                </li>
                <div v-else class="p-4"> Sem instâncias disponíveis</div>
            </ul>
        </nav>
    </main>
</template>